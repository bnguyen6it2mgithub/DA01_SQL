1. SELECT COUNT(company_id)
FROM(
SELECT company_id,
COUNT(*) AS listing_count
from job_listings
GROUP BY company_id
HAVING COUNT(*)>1) as duplicate_listing_company

2. SELECT product, category, total_spend
FROM
(SELECT product, category,
SUM(spend) as total_spend,
RANK() OVER(
PARTITION BY category
ORDER BY SUM(spend) DESC) AS ranking
FROM product_spend
where EXTRACT (YEAR FROM transaction_date)=2022
GROUP BY product, category) AS ranked_spending
where ranking<=2
ORDER BY category, product

3 WITH caller_count_cte AS(
SELECT policy_holder_id,
COUNT(case_id) as policy_holder_counts
FROM callers
GROUP BY policy_holder_id
HAVING COUNT(case_id)>=3
)

SELECT count(policy_holder_counts)
from caller_count_cte

4. 
